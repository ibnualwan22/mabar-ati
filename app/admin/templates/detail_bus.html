{% extends "_admin_layout.html" %}

{% block title %}Detail Bus: {{ bus.nama_armada }} {{ bus.nomor_lambung }}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h2">Detail Bus & Manifest</h1>
    <a href="{{ url_for('admin.manajemen_rombongan', id=bus.rombongan_id) }}" class="btn btn-secondary">&larr; Kembali ke Daftar Rombongan</a>
</div>

<div class="card mb-4">
    <div class="card-header">
        <h4>{{ bus.nama_armada }} - {{ bus.nomor_lambung or bus.plat_nomor }}</h4>
    </div>
    <div class="card-body">
        <p><strong>Rombongan:</strong> {{ bus.rombongan.nama_rombongan }}</p>
        <p><strong>Plat Nomor:</strong> {{ bus.plat_nomor or '-' }}</p>
        <p><strong>Keterangan:</strong> {{ bus.keterangan or '-' }}</p>
        <hr>
        <p class="h4">Kapasitas: <span class="fw-bold">{{ total_peserta }} / {{ bus.kuota }}</span> Terisi</p>
    </div>
</div>

<div class="card mb-4">
    <div class="card-header">
        <h5>Manifest Perjalanan Pulang (Meninggalkan Pondok)</h5>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-sm table-striped">
                <thead><tr><th>No.</th><th>Nama Santri</th><th>NIS</th><th>Asrama</th><th>Titik Turun</th></tr></thead>
                <tbody>
                    {% for p in peserta_pulang|sort(attribute='santri.nama') %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ p.santri.nama }}</td>
                        <td>{{ p.santri.nis }}</td>
                        <td>{{ p.santri.asrama }}</td>
                        <td>{{ p.titik_turun }}</td>
                    </tr>
                    {% else %}
                    <tr><td colspan="5" class="text-center">Tidak ada peserta untuk perjalanan pulang.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h5>Manifest Perjalanan Kembali (Menuju Pondok)</h5>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-sm table-striped">
                <thead><tr><th>No.</th><th>Nama Santri</th><th>NIS</th><th>Asrama</th></tr></thead>
                <tbody>
                    {% for p in peserta_kembali|sort(attribute='santri.nama') %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ p.santri.nama }}</td>
                        <td>{{ p.santri.nis }}</td>
                        <td>{{ p.santri.asrama }}</td>
                    </tr>
                    {% else %}
                    <tr><td colspan="4" class="text-center">Tidak ada peserta untuk perjalanan kembali.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}