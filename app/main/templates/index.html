{% extends "main_layout.html" %}

{% block title %}Halaman Utama{% endblock %}

{% block content %}
<header id="header-masthead" class="masthead" style="background-image: url('{{ url_for("static", filename="assets/img/header-bg.jpg") }}');">
    <div class="hero-slider" aria-hidden="true">
    <div class="hero-track" id="heroTrack">
        </div>
  </div>
        !-- KONTEN HEADER KAMU
  <div class="container position-relative">
            <div class="masthead-subheading">Selamat Datang di Platform Koordinasi Perpulangan</div>
            <div class="masthead-heading text-uppercase">Mabar Ati <div class="subtitle">(Mudik Akbar Santri Amtsilati)</div></div>
            
            {% if active_edisi and active_edisi.countdown_target_date %}
                <div id="countdown-title" class="masthead-subheading">{{ active_edisi.countdown_title }}</div>
                <div id="countdown" class="h1 text-warning mb-4"></div>
            {% endif %}
<a class="btn btn-primary btn-xl text-uppercase" href="{{ url_for('main.informasi_perpulangan') }}">Informasi Perpulangan</a>
<!-- <a class="btn btn-primary btn-xl text-uppercase" href="javascript:void(0)" onclick="showCredits()">Credits</a> -->

        </div>
    </header>
        <section class="page-section" id="services">
            <div class="container">
                <div class="text-center">
                    <h2 class="section-heading text-uppercase">Alur Pendaftaran</h2>
                    <h3 class="section-subheading text-muted">Ikuti langkah-langkah mudah berikut untuk mendaftar.</h3>
                </div>
                <div class="row text-center">
                    <div class="col-md-4">
                        <span class="fa-stack fa-4x">
                            <i class="fas fa-circle fa-stack-2x text-primary"></i>
                            <i class="fas fa-search fa-stack-1x fa-inverse"></i>
                        </span>
                        <h4 class="my-3">1. Cari Rombongan</h4>
                        <p class="text-muted">Gulir ke bawah ke bagian "Daftar Rombongan" dan temukan rombongan yang sesuai dengan daerah tujuan Anda.</p>
                    </div>
                    <div class="col-md-4">
                        <span class="fa-stack fa-4x">
                            <i class="fas fa-circle fa-stack-2x text-primary"></i>
                            <i class="fab fa-whatsapp fa-stack-1x fa-inverse"></i>
                        </span>
                        <h4 class="my-3">2. Hubungi Penanggung Jawab</h4>
                        <p class="text-muted">Klik pada rombongan untuk melihat detail. Hubungi nomor Penanggung Jawab (PJ) yang tertera untuk konfirmasi.</p>
                    </div>
                    <div class="col-md-4">
                        <span class="fa-stack fa-4x">
                            <i class="fas fa-circle fa-stack-2x text-primary"></i>
                            <i class="fas fa-money-check-alt fa-stack-1x fa-inverse"></i>
                        </span>
                        <h4 class="my-3">3. Lakukan Pembayaran</h4>
                        <p class="text-muted">Selesaikan pendaftaran dengan melakukan pembayaran ke nomor rekening yang tertera pada detail rombongan.</p>
                    </div>
                </div>
            </div>
        </section>
        
        <section class="page-section bg-light" id="portfolio">
    <div class="container">
        <div class="text-center">
            <h2 class="section-heading text-uppercase">Daftar Rombongan</h2>
            {% if active_edisi %}
                <h3 class="section-subheading text-muted">Edisi {{ active_edisi.nama }}</h3>
            {% else %}
                <h3 class="section-subheading text-muted">Saat ini belum ada edisi perpulangan yang aktif.</h3>
            {% endif %}
        </div>
        <div class="row justify-content-center mb-5">
            <div class="col-lg-8">
                <form method="GET" action="{{ url_for('main.index') }}#portfolio">
                    <div class="row g-2">
                        <div class="col-md-6">
                            <input type="text" name="q" class="form-control" placeholder="Cari nama rombongan..." value="{{ request.args.get('q', '') }}">
                        </div>
                        <div class="col-md-4">
                            <select name="wilayah" class="form-select">
                                <option value="">-- Pilih Wilayah --</option>
                                {% for wilayah in semua_wilayah %}
                                    <option value="{{ wilayah }}" {% if request.args.get('wilayah') == wilayah %}selected{% endif %}>
                                        {{ wilayah }}
                                    </option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-md-2">
                            <button type="submit" class="btn btn-primary w-100">Cari</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <div class="row">
            {% for rombongan in semua_rombongan %}
            <div class="col-lg-4 col-sm-6 mb-4">
                <div class="portfolio-item h-100">
                    <a class="portfolio-link" data-bs-toggle="modal" href="#portfolioModal{{ rombongan.id }}">
                        <div class="portfolio-hover">
                            <div class="portfolio-hover-content"><i class="fas fa-plus fa-3x"></i></div>
                        </div>
                        <img class="img-fluid" src="{{ url_for('static', filename='assets/img/portfolio/4.jpg') }}" alt="Gambar Rombongan" />
                    </a>
                    <div class="portfolio-caption">
                        <div class="portfolio-caption-heading">{{ rombongan.nama_rombongan }}</div>
                        <div class="portfolio-caption-subheading text-muted">{{ rombongan.cakupan_wilayah|map(attribute='label')|join(', ') }}</div>
                    </div>
                </div>
            </div>
            {% else %}
            <div class="col-12 text-center">
                <p>Belum ada rombongan yang dibuat untuk edisi ini.</p>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

{% if semua_rombongan %}
{% for rombongan in semua_rombongan %}
    <div class="portfolio-modal modal fade" id="portfolioModal{{ rombongan.id }}" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content border-0 shadow-lg">
                <div class="container-fluid">
                    <div class="row justify-content-center">
                        <div class="col-lg-12">
                            <div class="modal-body p-0">
                                <!-- Header Section -->
                                <div class="bg-gradient-primary text-white p-4 rounded-top position-relative overflow-hidden">
                                    <div class="position-absolute top-0 end-0 opacity-25">
                                        <i class="fas fa-bus fa-6x"></i>
                                    </div>
                                    <button type="button" class="btn-close btn-close-white position-absolute top-0 end-0 m-3" data-bs-dismiss="modal" aria-label="Close"></button>
                                    <div class="position-relative">
                                        <h2 class="text-white mb-2 fw-bold">{{ rombongan.nama_rombongan }}</h2>
                                        <p class="mb-0 opacity-75"><i class="fas fa-calendar-check me-2"></i>Edisi {{ active_edisi.nama }}</p>
                                    </div>
                                </div>

                                <!-- Content Section -->
                                <div class="p-4">
                                    <!-- Penanggung Jawab & Jadwal -->
                                    <div class="row g-4 mb-4">
                                        <div class="col-md-6">
                                            <div class="card border-0 bg-light h-100">
                                                <div class="card-header bg-white border-0 pb-0">
                                                    <h5 class="card-title text-secondary mb-0">
                                                        <i class="fas fa-users me-2"></i>Penanggung Jawab
                                                    </h5>
                                                </div>
                                                <div class="card-body pt-3">
                                                    <div class="row g-3">
                                                        <div class="col-12">
                                                            <div class="d-flex align-items-center justify-content-between p-3 bg-white rounded shadow-sm">
                                                                <div>
                                                                    <small class="text-muted d-block">PJ Putra</small>
                                                                    <strong class="text-dark">{{ rombongan.penanggung_jawab_putra or '-' }}</strong>
                                                                </div>
                                                                {% if rombongan.kontak_person_putra %}
                                                                <a href="https://wa.me/{{ rombongan.kontak_person_putra }}" target="_blank" class="btn btn-success btn-sm rounded-pill">
                                                                    <i class="fab fa-whatsapp me-1"></i> Hubungi
                                                                </a>
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                        <div class="col-12">
                                                            <div class="d-flex align-items-center justify-content-between p-3 bg-white rounded shadow-sm">
                                                                <div>
                                                                    <small class="text-muted d-block">PJ Putri</small>
                                                                    <strong class="text-dark">{{ rombongan.penanggung_jawab_putri or '-' }}</strong>
                                                                </div>
                                                                {% if rombongan.kontak_person_putri %}
                                                                <a href="https://wa.me/{{ rombongan.kontak_person_putri }}" target="_blank" class="btn btn-success btn-sm rounded-pill">
                                                                    <i class="fab fa-whatsapp me-1"></i> Hubungi
                                                                </a>
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="col-md-6">
                                            <div class="card border-0 bg-light h-100">
                                                <div class="card-header bg-white border-0 pb-0">
                                                    <h5 class="card-title text-secondary mb-0">
                                                        <i class="fas fa-calendar-alt me-2"></i>Jadwal
                                                    </h5>
                                                </div>
                                                <div class="card-body pt-3">
                                                    <div class="row g-3">
                                                        <div class="col-12">
                                                            <div class="p-3 bg-white rounded shadow-sm">
                                                                <div class="d-flex align-items-center">
                                                                    <div class="bg-light border rounded-circle p-2 me-3">
                                                                        <i class="fas fa-arrow-up text-muted"></i>
                                                                    </div>
                                                                    <div>
                                                                        <small class="text-muted d-block">Pulang</small>
                                                                        <strong class="text-dark">{{ rombongan.jadwal_pulang|datetime_wib if rombongan.jadwal_pulang else 'N/A' }}</strong>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-12">
                                                            <div class="p-3 bg-white rounded shadow-sm">
                                                                <div class="d-flex align-items-center">
                                                                    <div class="bg-light border rounded-circle p-2 me-3">
                                                                        <i class="fas fa-arrow-down text-muted"></i>
                                                                    </div>
                                                                    <div>
                                                                        <small class="text-muted d-block">Kembali</small>
                                                                        <strong class="text-dark">{{ rombongan.jadwal_berangkat|datetime_wib if rombongan.jadwal_berangkat else 'N/A' }}</strong>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Cakupan Wilayah & Informasi Pembayaran -->
                                    <div class="row g-4 mb-4">
                                        <div class="col-md-6">
                                            <div class="card border-0 shadow-sm">
                                                <div class="card-header bg-light text-dark border-0">
                                                    <h6 class="mb-0"><i class="fas fa-map-marked-alt me-2"></i>Cakupan Wilayah</h6>
                                                </div>
                                                <div class="card-body">
                                                    <p class="mb-0 text-muted">
                                                        {% if rombongan.cakupan_wilayah %}
                                                            <i class="fas fa-map-pin text-secondary me-2"></i>{{ rombongan.cakupan_wilayah|map(attribute='label')|join(', ') }}
                                                        {% else %}
                                                            <i class="fas fa-info-circle text-muted me-2"></i>Informasi cakupan wilayah belum tersedia.
                                                        {% endif %}
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="col-md-6">
                                            <div class="card border-0 shadow-sm">
                                                <div class="card-header bg-light text-dark border-0">
                                                    <h6 class="mb-0"><i class="fas fa-credit-card me-2"></i>Informasi Pembayaran</h6>
                                                </div>
                                                <div class="card-body">
                                                    <div class="d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <small class="text-muted d-block">No. Rekening</small>
                                                            <strong class="text-dark">{{ rombongan.nomor_rekening or 'Belum tersedia' }}</strong>
                                                        </div>
                                                        {% if rombongan.nomor_rekening %}
                                                        <button class="btn btn-outline-secondary btn-sm rounded-pill" onclick="copyToClipboard('{{ rombongan.nomor_rekening }}', this)">
                                                            <i class="fas fa-copy me-1"></i> Salin
                                                        </button>
                                                        {% endif %}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Daftar Bus & Pelacakan -->
                                    <div class="card border-0 shadow-sm mb-4">
    <div class="card-header bg-light text-dark border-0">
        <h5 class="mb-0"><i class="fas fa-bus-alt me-2"></i>Daftar Bus & Pelacakan</h5>
    </div>
    <div class="card-body p-0">
        {% for bus in rombongan.buses %}
        <div class="d-flex align-items-center justify-content-between p-3 border-bottom">
            <div class="d-flex align-items-center">
                <div class="bg-light border rounded-circle p-2 me-3">
                    <i class="fas fa-bus text-muted"></i>
                </div>
                <div>
                    <strong class="text-dark d-block">{{ bus.nama_armada }} - {{ bus.nomor_lambung or bus.plat_nomor }}</strong>
                </div>
            </div>
            
            {# --- PERUBAHAN LOGIKA DI SINI --- #}
            {% if bus.traccar_device_id %}
                {# Tombol ini sekarang mengarah ke halaman peta Traccar kita #}
                <a href="{{ url_for('main.lacak_bus', bus_id=bus.id) }}" target="_blank" class="btn btn-primary btn-sm rounded-pill">
                    <i class="fas fa-map-marker-alt me-1"></i> Lacak Lokasi
                </a>
            {% else %}
                <span class="badge bg-light text-dark border rounded-pill">Pelacakan Belum Aktif</span>
            {% endif %}
            {# --- AKHIR PERUBAHAN --- #}

        </div>
        {% else %}
        <div class="p-4 text-center text-muted">
            <i class="fas fa-info-circle fa-2x mb-2 d-block"></i>
            Informasi bus belum tersedia.
        </div>
        {% endfor %}
    </div>
</div>

                                    <!-- Detail Harga -->
                                    <div class="card border-0 shadow-sm">
                                        <div class="card-header bg-light text-dark border-0">
                                            <h5 class="mb-0"><i class="fas fa-money-bill-wave me-2"></i>Detail Harga per Titik Turun/Jemput</h5>
                                        </div>
                                        <div class="card-body p-0">
                                            <div class="table-responsive">
                                                <table class="table table-hover mb-0">
                                                    <thead class="bg-secondary text-white">
                                                        <tr>
                                                            <th class="border-0 py-3"><i class="fas fa-map-pin me-2"></i>Titik Turun/Jemput</th>
                                                            <th class="border-0 py-3"><i class="fas fa-money-bill-wave me-2"></i>Biaya per Perjalanan</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        {% for tarif in rombongan.tarifs %}
                                                        <tr>
                                                            <td class="py-3">
                                                                <div class="d-flex align-items-center">
                                                                    <div class="bg-light border rounded-circle p-1 me-2" style="width: 8px; height: 8px;"></div>
                                                                    {{ tarif.titik_turun }}
                                                                </div>
                                                            </td>
                                                            <td class="py-3">
                                                                <span class="badge bg-dark fs-6 px-3 py-2">
                                                                    Rp {{ "{:,.0f}".format((tarif.harga_bus|default(0)) + (tarif.fee_korda|default(0)) + 10000).replace(',', '.') }}
                                                                </span>
                                                            </td>
                                                        </tr>
                                                        {% else %}
                                                        <tr>
                                                            <td colspan="2" class="text-center py-4 text-muted">
                                                                <i class="fas fa-info-circle fa-2x mb-2 d-block"></i>
                                                                Informasi tarif belum tersedia.
                                                            </td>
                                                        </tr>
                                                        {% endfor %}
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Close Button -->
                                    <div class="text-center mt-4 pt-3 border-top">
                                        <button class="btn btn-danger btn-lg rounded-pill px-5" data-bs-dismiss="modal" type="button">
                                            <i class="fas fa-times me-2"></i> Tutup
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
{% endif %}

         <section class="gallery-section" id="gallery">
        <div class="floating-shapes">
            <div class="shape"></div>
            <div class="shape"></div>
            <div class="shape"></div>
        </div>
        
        <div class="section-header">
            <h2 class="section-title">Galeri Momen</h2>
            <p class="section-subtitle">Dokumentasi perjalanan dan kebersamaan Mabar Ati dalam melayani koordinasi perpulangan</p>
        </div>
        
        <div class="slider-container">
            <button class="play-pause-btn" id="playPauseBtn">
                <i class="fas fa-pause"></i>
            </button>
            
            <div class="slider-counter">
                <span id="currentSlide">1</span> / <span id="totalSlides">11</span>
            </div>
            
            <div class="slider-wrapper" id="sliderWrapper">
                <div class="slide">
                    <img src="{{ url_for('static', filename='assets/img/about/1.jpg') }}" alt="Photo 1" />
                </div>
                <div class="slide">
                    <img src="{{ url_for('static', filename='assets/img/about/2.jpg') }}" alt="Photo 2" />
                </div>
                <div class="slide">
                    <img src="{{ url_for('static', filename='assets/img/about/3.jpg') }}" alt="Photo 3" />
                </div>
                <div class="slide">
                    <img src="{{ url_for('static', filename='assets/img/about/4.jpg') }}" alt="Photo 4" />
                </div>
                <div class="slide">
                    <img src="{{ url_for('static', filename='assets/img/about/1.jpg') }}" alt="Photo 5" />
                </div>
                <div class="slide">
                    <img src="{{ url_for('static', filename='assets/img/about/2.jpg') }}" alt="Photo 6" />
                </div>
                <div class="slide">
                    <img src="{{ url_for('static', filename='assets/img/about/3.jpg') }}" alt="Photo 7" />
                </div>
                <div class="slide">
                    <img src="{{ url_for('static', filename='assets/img/about/4.jpg') }}" alt="Photo 8" />
                </div>
                <div class="slide">
                    <img src="{{ url_for('static', filename='assets/img/about/1.jpg') }}" alt="Photo 9" />
                </div>
                <div class="slide">
                    <img src="{{ url_for('static', filename='assets/img/about/2.jpg') }}" alt="Photo 10" />
                </div>
                <div class="slide">
                    <img src="{{ url_for('static', filename='assets/img/about/3.jpg') }}" alt="Photo 11" />
                </div>
            </div>
            
            <button class="slider-nav prev" id="prevBtn">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="slider-nav next" id="nextBtn">
                <i class="fas fa-chevron-right"></i>
            </button>
            
            <div class="slider-dots" id="sliderDots">
                <div class="dot active" data-slide="0"></div>
                <div class="dot" data-slide="1"></div>
                <div class="dot" data-slide="2"></div>
                <div class="dot" data-slide="3"></div>
                <div class="dot" data-slide="4"></div>
                <div class="dot" data-slide="5"></div>
                <div class="dot" data-slide="6"></div>
                <div class="dot" data-slide="7"></div>
                <div class="dot" data-slide="8"></div>
                <div class="dot" data-slide="9"></div>
                <div class="dot" data-slide="10"></div>
            </div>
        </div>
    </section>

        <section class="page-section bg-light" id="team">
            <div class="container">
                <div class="text-center">
                    <h2 class="section-heading text-uppercase">Contact Person</h2>
                    <h3 class="section-subheading text-muted">Nomor-nomor penting Seputar Perpulangan</h3>
                </div>
                <div class="row justify-content-center">
    <div class="col-lg-4">
        <div class="team-member">
            <img class="mx-auto rounded-circle" src="{{ url_for('static', filename='assets/img/team/1.jpg') }}" alt="..." />
            <h4>Keamanan Putra</h4>
            <p class="text-muted">
                <a href="https://wa.me/62895325578379" target="_blank">+62 895-3255-78379</a>
            </p>
        </div>
    </div>


                    <div class="col-lg-4">
                        <div class="team-member">
                            <img class="mx-auto rounded-circle" src="{{ url_for('static', filename='assets/img/team/2.jpg') }}" alt="..." />
                            <h4>Keamanan Putri</h4>
                            <p class="text-muted">
                <a href="https://wa.me/6285742572990" target="_blank">+62 857-4257-2990</a>
            </p>
                        </div>
                    </div>
                    
                    <div class="col-lg-4">
                        <div class="team-member">
                            <img class="mx-auto rounded-circle" src="{{ url_for('static', filename='assets/img/team/2.jpg') }}" alt="..." />
                            <h4>Keamanan Putri</h4>
                            <p class="text-muted">
                <a href="https://wa.me/6285742572990" target="_blank">+62 857-4257-2990</a>
            </p>
                        </div>
                    </div>
                    
                    <div class="col-lg-4">
                        <div class="team-member">
                            <img class="mx-auto rounded-circle" src="{{ url_for('static', filename='assets/img/team/2.jpg') }}" alt="..." />
                            <h4>Keamanan Putri</h4>
                            <p class="text-muted">
                <a href="https://wa.me/6285742572990" target="_blank">+62 857-4257-2990</a>
            </p>
                        </div>
                    </div>
                    
                    <div class="col-lg-4">
                        <div class="team-member">
                            <img class="mx-auto rounded-circle" src="{{ url_for('static', filename='assets/img/team/2.jpg') }}" alt="..." />
                            <h4>Keamanan Putri</h4>
                            <p class="text-muted">
                <a href="https://wa.me/6285742572990" target="_blank">+62 857-4257-2990</a>
            </p>
                        </div>
                    </div>
                    
                    <div class="col-lg-4">
                        <div class="team-member">
                            <img class="mx-auto rounded-circle" src="{{ url_for('static', filename='assets/img/team/2.jpg') }}" alt="..." />
                            <h4>Keamanan Putri</h4>
                            <p class="text-muted">
                <a href="https://wa.me/6285742572990" target="_blank">+62 857-4257-2990</a>
            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

<div class="credits-overlay" id="creditsOverlay">
        <button class="close-credits" onclick="hideCredits()">✕ Tutup Credits</button>
        
        <div class="credits-content">
            <div class="credits-inner">
                <h1 class="credits-title">Mabar Ati</h1>
                <p class="credits-subtitle">Kami Ucapkan Terimakasih Kepada :</p>
                
                <div class="credits-scroll">
                    <div class="credits-list" id="creditsList">
                        
                        <div class="credit-section">
                            <div class="divine-credit">
                                <div class="credit-name">Allah SWT</div>
                                <div class="credit-role">Atas segala rahmat, nikmat, dan karunia-Nya yang tak terhitung</div>
                            </div>
                        </div>

                        <div class="credit-section">
                            <div class="divine-credit">
                                <div class="credit-name">Nabi Muhammad SAW</div>
                                <div class="credit-role">Sebagai suri tauladan terbaik bagi seluruh umat</div>
                            </div>
                        </div>

                        <div class="ornament">❦</div>

                        <div class="credit-section">
                            <div class="section-title">Spiritual Leadership</div>
                            
                            <div class="leadership-credit">
                                <div class="credit-name">KH. Taufiqul Hakim Beserta Keluarga</div>
                                <div class="credit-role">Pengasuh Pondok Pesantren Darul Falah Amtsilati</div>
                                <div class="credit-details">Atas segala bimbingan dan doa restunya</div>
                            </div>

                            <div class="leadership-credit">
                                <div class="credit-name">Gus Rizqi Al-Mubarok Beserta Keluarga</div>
                                <div class="credit-role">Pengasuh Pondok Pesantren Musa Al-Mubarok</div>
                                <div class="credit-details">Atas segala doa dan dukungannya yang tak ternilai</div>
                            </div>

                            <div class="leadership-credit">
                                <div class="credit-name">Ust. Abdussalam</div>
                                <div class="credit-role">Ketua Pondok Pesantren Darul Falah Amtsilati Putra</div>
                            </div>
                            <div class="leadership-credit">
                                <div class="credit-name">Ustadzah Siti Nur Kholida</div>
                                <div class="credit-role">Ketua Pondok Pesantren Darul Falah Amtsilati</div>
                            </div>
                        </div>

                        <div class="ornament">❦</div>

                        <div class="credit-section">
                            <div class="section-title">Executive Production</div>
                            
                            <div class="group-credit">
                                <div class="credit-name">Seluruh Crew Inti Mabar-Ati</div>
                                <div class="credit-role">Behind The Scenes</div>
                                <div class="credit-details">Ust. Rofeq, Ust. Ulil Abshor, Ust. Labib Yahya, dan lainnya</div>
                            </div>

                            <div class="group-credit">
                                <div class="credit-name">Kabinet "Ahsin Kama Ahsanallahu Ilaik"</div>
                                <div class="credit-role">Organizational Committee</div>
                            </div>
                        </div>

                        <div class="ornament">❦</div>

                        <div class="credit-section">
                            <div class="section-title">Regional Coordination</div>
                            
                            <div class="group-credit">
                                <div class="credit-name">Koordinator Daerah (Korda)</div>
                                <div class="credit-role">Regional Directors</div>
                                <div class="credit-details">Ust. Mufti (Korda Iksapba), Ust. Nasrul Arif (Korda Sumatra), dan lainnya</div>
                            </div>

                            <div class="group-credit">
                                <div class="credit-name">Koordinator Lapangan Daerah (Korlapda)</div>
                                <div class="credit-role">Field Coordinators</div>
                                <div class="credit-details">Ust. Anas, Ust. Raju, dan lainnya</div>
                            </div>
                        </div>

                        <div class="ornament">❦</div>

                        <div class="credit-section">
                            <div class="section-title">Supporting Cast</div>
                            
                            <div class="group-credit">
                                <div class="credit-name">Seluruh Wali Santri</div>
                                <div class="credit-role">Trusted Partners</div>
                                <div class="credit-details">Atas kepercayaan yang telah diberikan kepada kami</div>
                            </div>

                            <div class="group-credit">
                                <div class="credit-name">Kepengurusan Pondok Pesantren</div>
                                <div class="credit-role">Institutional Support</div>
                            </div>

                            <div class="group-credit">
                                <div class="credit-name">Seluruh Santri Peserta</div>
                                <div class="credit-role">Main Participants</div>
                                <div class="credit-details">Perpulangan Santri Program</div>
                            </div>

                            <div class="group-credit">
                                <div class="credit-name">Masyarakat Darul Falah</div>
                                <div class="credit-role">Community Support</div>
                                <div class="credit-details">Dan seluruh pihak yang tidak dapat kami sebutkan satu per satu, tanpa mengurangi rasa hormat kami</div>
                            </div>
                        </div>

                        <div class="ornament">❦</div>

                        <div class="credit-section">
                            <div class="final-message">
                                <div class="message-text">
                                    Semoga Allah SWT membalas semua kebaikan Anda dengan balasan yang berlipat ganda.
                                </div>
                                <div class="aamiin">Aamiin Ya Rabbal Alamiin</div>
                            </div>
                        </div>

                        <div style="height: 200px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <style>
        
    </style>
        <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="{{ url_for('static', filename='js/scripts.js') }}"></script> -->
<script>
const countdownElement = document.getElementById('countdown');
    // Ambil tanggal target dari data yang dikirim Flask/Jinja2
    const targetDate = new Date("{{ active_edisi.countdown_target_date.isoformat() if active_edisi and active_edisi.countdown_target_date else '' }}").getTime();

    if (countdownElement && targetDate) {
        const interval = setInterval(function() {
            const now = new Date().getTime();
            const distance = targetDate - now;

            // Kalkulasi waktu
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            // Tampilkan hasilnya
            countdownElement.innerHTML = days + "Hari " + hours + "j " + minutes + "m " + seconds + "d Lagi";

            // Jika hitung mundur selesai
            if (distance < 0) {
                clearInterval(interval);
                countdownElement.innerHTML = "WAKTU TELAH TIBA";
            }
        }, 1000);
    }
    function copyToClipboard(text, buttonElement) {
    navigator.clipboard.writeText(text).then(function() {
        // Beri tahu user bahwa teks sudah disalin
        const originalText = buttonElement.innerHTML;
        buttonElement.innerHTML = '<i class="fas fa-check me-1"></i> Tersalin!';
        setTimeout(function() {
            buttonElement.innerHTML = originalText;
        }, 2000); // Kembalikan ke teks semula setelah 2 detik
    }, function(err) {
        alert('Gagal menyalin nomor rekening.');
    });
}
document.addEventListener('DOMContentLoaded', function () {
  // 1) Daftar gambar
  const images = [
    "{{ url_for('static', filename='assets/img/header-bg.jpg') }}",
    "{{ url_for('static', filename='assets/img/header-bg-2.jpg') }}",
    "{{ url_for('static', filename='assets/img/header-bg-3.jpg') }}"
  ];

  // 2) Bangun slide
  const track = document.getElementById('heroTrack');
  images.forEach(src => {
    const slide = document.createElement('div');
    slide.className = 'hero-slide';
    slide.style.backgroundImage = `url('${src}')`;
    track.appendChild(slide);
  });

  // 3) State & helper
  let index = 0;
  const total = images.length;
  const delay = 5000; // 5 dtk
  let timer;

  function go(i){
    index = (i + total) % total;
    track.style.transform = `translateX(${ -index * 100 }%)`;
  }

  function start(){
    stop();
    timer = setInterval(() => go(index + 1), delay);
  }
  function stop(){ if (timer) clearInterval(timer); }

  // 4) Mulai
  go(0);
  start();

  // Pause saat tab tidak terlihat (hemat & hindari loncat)
  document.addEventListener('visibilitychange', () => {
    document.hidden ? stop() : start();
  });

  // (Opsional) dukungan swipe di header
  let sx = null;
  const header = document.getElementById('header-masthead');
  header.addEventListener('touchstart', e => sx = e.touches[0].clientX, {passive:true});
  header.addEventListener('touchend', e => {
    if (sx == null) return;
    const dx = e.changedTouches[0].clientX - sx;
    if (Math.abs(dx) > 50){
      stop();
      go(index + (dx < 0 ? 1 : -1));
      start();
    }
    sx = null;
  });
});

class PhotoSlider {
            constructor() {
                this.currentSlide = 0;
                this.totalSlides = 11;
                this.isPlaying = true;
                this.autoPlayInterval = null;
                this.autoPlayDelay = 4000; // 4 seconds
                
                this.sliderWrapper = document.getElementById('sliderWrapper');
                this.prevBtn = document.getElementById('prevBtn');
                this.nextBtn = document.getElementById('nextBtn');
                this.playPauseBtn = document.getElementById('playPauseBtn');
                this.dots = document.querySelectorAll('.dot');
                this.currentSlideSpan = document.getElementById('currentSlide');
                
                this.init();
            }
            
            init() {
                this.addEventListeners();
                this.startAutoPlay();
                this.updateSlider();
            }
            
            addEventListeners() {
                this.prevBtn.addEventListener('click', () => this.prevSlide());
                this.nextBtn.addEventListener('click', () => this.nextSlide());
                this.playPauseBtn.addEventListener('click', () => this.toggleAutoPlay());
                
                this.dots.forEach((dot, index) => {
                    dot.addEventListener('click', () => this.goToSlide(index));
                });
                
                // Touch/swipe support
                let startX = null;
                this.sliderWrapper.addEventListener('touchstart', (e) => {
                    startX = e.touches[0].clientX;
                });
                
                this.sliderWrapper.addEventListener('touchmove', (e) => {
                    if (!startX) return;
                    e.preventDefault();
                });
                
                this.sliderWrapper.addEventListener('touchend', (e) => {
                    if (!startX) return;
                    
                    const endX = e.changedTouches[0].clientX;
                    const diff = startX - endX;
                    
                    if (Math.abs(diff) > 50) {
                        if (diff > 0) {
                            this.nextSlide();
                        } else {
                            this.prevSlide();
                        }
                    }
                    
                    startX = null;
                });
                
                // Keyboard navigation
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'ArrowLeft') this.prevSlide();
                    if (e.key === 'ArrowRight') this.nextSlide();
                    if (e.key === ' ') {
                        e.preventDefault();
                        this.toggleAutoPlay();
                    }
                });
                
                // Pause on hover
                this.sliderWrapper.addEventListener('mouseenter', () => {
                    if (this.isPlaying) this.pauseAutoPlay();
                });
                
                this.sliderWrapper.addEventListener('mouseleave', () => {
                    if (this.isPlaying) this.startAutoPlay();
                });
            }
            
            nextSlide() {
                this.currentSlide = (this.currentSlide + 1) % this.totalSlides;
                this.updateSlider();
                this.resetAutoPlay();
            }
            
            prevSlide() {
                this.currentSlide = (this.currentSlide - 1 + this.totalSlides) % this.totalSlides;
                this.updateSlider();
                this.resetAutoPlay();
            }
            
            goToSlide(index) {
                this.currentSlide = index;
                this.updateSlider();
                this.resetAutoPlay();
            }
            
            updateSlider() {
                const translateX = -this.currentSlide * (100 / this.totalSlides);
                this.sliderWrapper.style.transform = `translateX(${translateX}%)`;
                
                // Update dots
                this.dots.forEach((dot, index) => {
                    dot.classList.toggle('active', index === this.currentSlide);
                });
                
                // Update counter
                this.currentSlideSpan.textContent = this.currentSlide + 1;
            }
            
            startAutoPlay() {
                if (!this.isPlaying) return;
                
                this.autoPlayInterval = setInterval(() => {
                    this.nextSlide();
                }, this.autoPlayDelay);
            }
            
            pauseAutoPlay() {
                if (this.autoPlayInterval) {
                    clearInterval(this.autoPlayInterval);
                    this.autoPlayInterval = null;
                }
            }
            
            resetAutoPlay() {
                this.pauseAutoPlay();
                if (this.isPlaying) {
                    this.startAutoPlay();
                }
            }
            
            toggleAutoPlay() {
                this.isPlaying = !this.isPlaying;
                const icon = this.playPauseBtn.querySelector('i');
                
                if (this.isPlaying) {
                    icon.className = 'fas fa-pause';
                    this.startAutoPlay();
                } else {
                    icon.className = 'fas fa-play';
                    this.pauseAutoPlay();
                }
            }
        }
        
        // Initialize slider when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new PhotoSlider();
        });
</script>
{% endblock %}
